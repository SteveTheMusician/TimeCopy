(()=>{var e,t,n,i,o={907:(e,t,n)=>{var i={"./AmagProTime/AmagProTime.content.js":[964,964]};function o(e){if(!n.o(i,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],o=t[0];return n.e(t[1]).then((()=>n(o)))}o.keys=()=>Object.keys(i),o.id=907,e.exports=o},647:(e,t,n)=>{var i={"./AmagProTime/info.json":[376,376],"./Automatic/info.json":[13,13],"./DZBankProRes/info.json":[851,851]};function o(e){if(!n.o(i,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],o=t[0];return n.e(t[1]).then((()=>n.t(o,19)))}o.keys=()=>Object.keys(i),o.id=647,e.exports=o}},r={};function c(e){var t=r[e];if(void 0!==t)return t.exports;var n=r[e]={exports:{}};return o[e](n,n.exports,c),n.exports}c.m=o,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,c.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"==typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"==typeof n.then)return n}var o=Object.create(null);c.r(o);var r={};e=e||[null,t({}),t([]),t(t)];for(var a=2&i&&n;"object"==typeof a&&!~e.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach((e=>r[e]=()=>n[e]));return r.default=()=>n,c.d(o,r),o},c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.f={},c.e=e=>Promise.all(Object.keys(c.f).reduce(((t,n)=>(c.f[n](e,t),t)),[])),c.u=e=>e+".bundle.js",c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},i="time-copy:",c.l=(e,t,o,r)=>{if(n[e])n[e].push(t);else{var a,l;if(void 0!==o)for(var s=document.getElementsByTagName("script"),d=0;d<s.length;d++){var m=s[d];if(m.getAttribute("src")==e||m.getAttribute("data-webpack")==i+o){a=m;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,c.nc&&a.setAttribute("nonce",c.nc),a.setAttribute("data-webpack",i+o),a.src=e),n[e]=[t];var u=(t,i)=>{a.onerror=a.onload=null,clearTimeout(g);var o=n[e];if(delete n[e],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((e=>e(i))),t)return t(i)},g=setTimeout(u.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=u.bind(null,a.onerror),a.onload=u.bind(null,a.onload),l&&document.head.appendChild(a)}},c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;c.g.importScripts&&(e=c.g.location+"");var t=c.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!e||!/^http(s?):/.test(e));)e=n[i--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),c.p=e})(),(()=>{var e={524:0};c.f.j=(t,n)=>{var i=c.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var o=new Promise(((n,o)=>i=e[t]=[n,o]));n.push(i[2]=o);var r=c.p+c.u(t),a=new Error;c.l(r,(n=>{if(c.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+r+")",a.name="ChunkLoadError",a.type=o,a.request=r,i[1](a)}}),"chunk-"+t,t)}};var t=(t,n)=>{var i,o,[r,a,l]=n,s=0;if(r.some((t=>0!==e[t]))){for(i in a)c.o(a,i)&&(c.m[i]=a[i]);l&&l(c)}for(t&&t(n);s<r.length;s++)o=r[s],c.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunktime_copy=self.webpackChunktime_copy||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),(()=>{"use strict";const e=JSON.parse('{"Re":"0.9.17","rf":"24.09031619-S","Fe":"1.5"}');function t(e,t,i){document.getElementsByTagName("main")[0].insertAdjacentHTML("beforeend",'<div class="notification flex notification--hidden" id="notification">\n                                <p class="text-label text-notification" id="notification-text"></p>\n                                <button class="button-primary" id="button_close-notification">\n                                    <?xml version="1.0" encoding="UTF-8" standalone="no"?>\n                                    <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n                                    <svg width="100%" height="100%" viewBox="0 0 1000 1000" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">\n                                        <g transform="matrix(0.924519,-0.924519,0.924519,0.924519,-424.346,499.846)">\n                                            <path id="addsmooth_path" d="M999.7,500.2C999.7,525 989.6,547.5 973.4,563.7C957.1,580 934.7,590 909.9,590L588.6,590L588.6,909.8C588.6,959.4 548.4,999.7 498.7,999.7C473.9,999.7 451.4,989.6 435.2,973.4C418.9,957.1 408.9,934.7 408.9,909.9L408.9,590.1L89.9,590.1C40.2,590.1 0,549.8 0,500.2C0,475.4 10.1,452.9 26.3,436.7C42.6,420.4 65,410.4 89.8,410.4L408.8,410.4L408.8,89.8C408.8,40.2 449,-0.1 498.7,-0.1C523.5,0 546,10 562.2,26.3C578.5,42.6 588.5,65 588.5,89.8L588.5,410.4L909.8,410.4C959.5,410.4 999.7,450.6 999.7,500.2Z" style="fill-rule:nonzero;"/>\n                                        </g>\n                                    </svg>\n                                </button>\n                            </div>');let o=document.getElementById("notification"),r=document.getElementById("notification-text");!0===e?(r.innerHTML=i,t?(o.classList.add("notification--ok"),function(e){setTimeout((function(){n(e)}),3e3)}(o)):(o.classList.remove("notification--ok"),function(e){setTimeout((function(){n(e)}),4500)}(o)),setTimeout((function(){o.classList.remove("notification--hidden")}),300)):!1!==e&&null!==e||setTimeout((function(){o.classList.add("notification--hidden")}),300),document.getElementById("button_close-notification").addEventListener("click",(function(){n(o)}))}function n(e,t,n){e.classList.add("notification--hidden")}let i="*",o=0;async function r(e,t,n){chrome.windows.getCurrent((function(e){chrome.windows.update(e.id,{focused:!0})}));try{let[i]=await chrome.tabs.query({active:!0,currentWindow:!0});await chrome.scripting.executeScript({target:{tabId:i.id},func:a,args:[e,t,n]})}catch(e){throw console.error("Error in chromeTabScript execution: ",e),e}}async function a(e,t,n){function i(){return new Promise((e=>{setTimeout((()=>{e("Timer done")}),300)}))}try{let e=await function(e){return new Promise((t=>{if(0===e){if(!document.getElementById("timeCopyProTimeClick")){let e=document.createElement("div"),t=document.createElement("div");e.setAttribute("id","timeCopyProTimeClick"),e.setAttribute("class","TimeCopy-ProtTime-clickArea"),e.setAttribute("style","position: fixed; width: 100%; height: 100%; z-index: 9999; background-color: #031a21ee; top: 0; left: 0; display: flex; justify-content: center; align-items: center; cursor: pointer;"),e.setAttribute("onClick",'document.getElementById("timeCopyProTimeClick").remove()'),t.setAttribute("style","width: 30%; height: 12%; border: 2px dashed #5ecac3; font-size: 24px; color: #5ecac3; padding: 20px; border-radius: 20px; display: flex; justify-content: center; align-items: center;"),t.innerHTML="Click here to focus window",e.appendChild(t),document.getElementsByTagName("body")[0].appendChild(e),e.addEventListener("click",n)}}else n();function n(){t("ok")}}))}(n);console.log(e)}catch(e){return alert(e),void console.error("Error in checkFirstBookingLoop: ",e)}const o=new KeyboardEvent("keydown",{key:"Enter",code:"Enter",which:13,keyCode:13}),r=new Event("change"),c=e[0],a=e[1];let l,s,d,m,u,g,f=document.getElementsByClassName("lsField--f4")[0];if(!(f&&f.childNodes&&f.childNodes.length>0))return;{let e=c.item_bookingnumber||a.projectnomber;if(!e)return;f.childNodes[0].value=e,f.childNodes[0].dispatchEvent(o)}try{await i()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}if(document.getElementsByClassName("lsField--list")[1].childNodes[0].click(),g=document.querySelector({select_proTime_service_CSITEST:"[data-itemkey='ZCHN0730070']",select_proTime_service_CSITENT:"[data-itemkey='ZCHN0730080']",select_proTime_service_ITDNT:"[data-itemkey='ZCHN0730005']",select_proTime_service_ITD:"[data-itemkey='ZCHN0730001']"}[a.protimeservice]),!g)return;g.click();try{await i()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}if(a.protimeactivity.length>1){d=document.getElementsByClassName("lsField--list")[2].childNodes[0],d.click(),m=document.getElementsByClassName("lsListbox__items")[1].childNodes[0];let e=m.childNodes;for(let t=0,n=e.length;t<n;t++)e[t].textContent.includes(a.protimeactivity)&&e[t].click();u=4}else u=3;try{await i()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}l=document.getElementsByClassName("lsField--right")[0].childNodes[0],l.focus(),l.click(),l.value=c.item_tickettime,t||l.dispatchEvent(o);try{await i()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}try{await i()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}try{await i()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}let p=c.item_ticketmasternumber?c.item_ticketmasternumber:c.item_ticketnumber;s=document.getElementsByClassName("lsField--list")[u].childNodes[0],s.focus(),s.click(),s.value=p,t||s.dispatchEvent(o);try{await i()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}let h=document.getElementsByTagName("textarea")[0],v=new MouseEvent("mouseover",{view:window,bubbles:!0,cancelable:!0}),_="["+c.item_ticketnumber+"] "+c.item_ticketdisc,b=new Event("focus");h.dispatchEvent(v),h.dispatchEvent(b),h.focus(),h.click(),h.value=_,document.getElementsByTagName("textarea")[0].dispatchEvent(r),document.getElementsByTagName("textarea")[1].focus(),document.getElementsByTagName("textarea")[1].setSelectionRange(document.getElementsByTagName("textarea")[1].value.length,document.getElementsByTagName("textarea")[1].value.length);try{await i()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}if(console.log("DEV-TestMode: "+t),!t){let e=document.getElementsByClassName("lsToolbar--item-button")[8];e.focus(),e.click()}try{await i()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}try{await i()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}try{await i()}catch(e){return alert(e),void console.error("Error in waitTimer: ",e)}return n}const l=["Automatic","AmagProTime","DZBankProRes"],s="Automatic",d="bookingPlatform_";async function m(e){try{return await c(907)(`./${e}/${e}.content.js`)}catch(t){throw console.error(`Failed to load module: ${e}`,t),t}}async function u(e,n,c,a){let d=[],m=e;l.forEach((e=>{d[e]=async function(e,n,c){return await async function(e,n,c){let a=[],l=[];try{e.forEach((e=>{let t=function(e,t){let n=[];return t.forEach((t=>{(t.ticketprefix.length>0&&e.item_ticketnumber.includes(t.ticketprefix)||0===t.ticketprefix.length&&0===e.item_ticketnumber.length)&&n.push(t)})),n||null}(e,n),o=function(e,t){let n=[];return t.forEach((t=>{let i=e.item_ticketdisc+" "+e.item_hiddentag;(t.addprefix.length>0&&i.includes(t.addprefix)||0===t.addprefix.length)&&n.push(t)})),n||null}(e,t);console.log("--\x3ePM: ",o);let r=function(e,t){console.log("T",e);let n=[];return t.length>1?t.forEach((t=>{let i=e.item_ticketdisc+" "+e.item_hiddentag;t.addprefix.length>0&&i.includes(t.addprefix)&&e.item_ticketnumber.includes(t.ticketprefix)&&n.push(t)})):n=t,n}(e,o);console.log("--\x3eAM: ",r);let c=function(e,t){let n=[];return t.length>1?t.forEach((t=>{(e.item_bookingnumber.length&&t.projectnomber===e.item_bookingnumber||e.item_bookingnumber&&t.projectnomber===i||!e.item_bookingnumber&&t.projectnomber.length&&t.projectnomber!==i)&&n.push(t)})):n=t,n}(e,r);if(e.item_ticketdisc.length<2)throw new Error("Ticket hat keine Discription! "+e.item_ticketnumber+" "+e.item_bookingnumber);if(c.length>1)throw new Error("Ticket hat mehrfache Matches | "+e.item_ticketnumber+" "+e.item_ticketdisc);if(1===c.length?a.push([e,c[0]]):0===c.length&&l.push(e),/\p{L}/u.test(e.item_tickettime))throw new Error("Ticket hat ungew√∂hnliche Zeitangabe! | "+e.item_ticketnumber+" "+e.item_ticketdisc);if(console.log("Infos: ",c),e.item_bookingnumber.length<1&&c.length>0&&c[0].projectnomber.length<1)throw new Error("Buchungsnummer fehlt im Ticket/in der Erkennung | "+e.item_ticketnumber+" "+e.item_ticketdisc);console.log("ticket filter matches ",e,c)}))}catch(e){return void t(!0,!1,e)}if(l.length){t(!0,!1,"‚ö†Ô∏è "+l.length+'<span id="fail-link">Ticket(s)</span> wurden nicht √ºbernommen.'),console.log("failed tickets ",l);var s=[];l.forEach((e=>{let t,n;t=e.item_ticketnumber.length?e.item_ticketnumber:"NO NOMBER",n=e.item_ticketdisc.length?e.item_ticketdisc:"NO DISCRIPTION",s.push(" >> ",t,": ",n," << ")}));let e=JSON.stringify(s);document.getElementById("fail-link").addEventListener("click",(()=>alert("Ignorierte Tickets: "+e.replace(/]|[[",]/g,""))))}console.log("valide ",a);try{if(!a.length)throw new Error("Es konnten keine Daten erfasst werden.");for(let e=0;e<a.length;e++){let t=a[e];try{await r(t,c,o),o++,console.log("--\x3e valid tickets loop")}catch(e){return console.error("Error in chromeTabScript: ",e),Promise.reject(new Error(400))}}}catch(e){return void t(!0,!1,e)}return o=0,"ProTime Buchung abgeschlossen"}(e,n,c)}})),m===s&&(m=await async function(){let e,n,[i]=await chrome.tabs.query({active:!0,lastFocusedWindow:!0});e=i.url;let o=localStorage.getItem("tc_s_dlcplatforminformations");o=JSON.parse(o);let r=o.find((t=>{const n=Object.keys(t)[0];if(e.includes(t[n].platform_url))return t[n].platform_url}));n=Object.keys(r)[0];try{if(!n)throw new Error("Buchung abgebrochen: Unbekannte URL")}catch(e){return void t(!0,!1,e)}return n}(),e=e.replace(s,m));let u=JSON.parse(c),g=[],f="select_"+e;for(let e=0;e<u.length;e++)u[e].bookingsheet===f&&(g=[...g,u[e]]);return m?d[m](n,g,a):null}function g(e){e&&(document.getElementById("window_detection").innerHTML=e.map((e=>'<div class="config-item detection-item flex" name="item_detection" id="'+e.id+'">\n     <div class="config-item-main-container">\n       <div class="config-item-title-row flex">\n         <p class="subtext subtext-top">Erkennung</p>\n       </div>\n       <div>\n         <select class="input-size--small" id="select_bookingPlatform_'+e.id+'">\n           <option value="" selected disabled hidden>Keine</option>\n           <option value="select_bookingPlatform_AmagProTime" >ProTime</option>\n           <option value="select_bookingPlatform_DZBankProRes">ProRes ‚≠êÔ∏è</option>\n         </select>\n         <input type="text" class="input-size--default '+(e.bookingsheet?"":"dNone")+'" name="input_ticketPrefix" id="input_ticketPrefix'+e.id+'" placeholder="Ticket Prefix" value="'+e.ticketprefix+'" />\n       </div>\n       <div>\n         <input type="text" class="input-size--large '+(e.bookingsheet?"":"dNone")+'" name="input_additionalPrefix" id="input_additionalPrefix'+e.id+'" placeholder="String Match (Optional)" value="'+e.addprefix+'"/>\n       </div>\n       <div class="config-item-title-row flex '+("AmagProTime"===e.bookingsheet?null:"dNone")+'">\n         <p class="subtext subtext-top">Buchung</p>\n       </div>\n       <div class="project-detection-item--amagprotime '+("AmagProTime"===e.bookingsheet?null:"dNone")+'">\n          <div>\n            <select class="input-size--default" name="select_proTimeService" id="select_proTimeService_'+e.id+'">\n              <option value="select_proTime_service_ITD" '+("select_proTime_service_ITD"===e.protimeservice?"selected":"")+'>IT Dienstleistungen</option>\n              <option value="select_proTime_service_ITDST" '+("select_proTime_service_ITDST"===e.protimeservice?"selected":"")+'>IT Dienstleistungen ST</option>\n              <option value="select_proTime_service_CSITEST" '+("select_proTime_service_CSITEST"===e.protimeservice?"selected":"")+'>Corporate Service IT Ext ST</option>\n              <option value="select_proTime_service_CSITENT" '+("select_proTime_service_CSITENT"===e.protimeservice?"selected":"")+'>Corporate Service IT Ext NT</option>\n            </select>\n            <input type="text" class="input-size--small" name="input_projectNomber" id="input_projectNomber'+e.id+'" placeholder="Projektnum." value="'+e.projectnomber+'"/>\n          </div>\n  \n          <input type="text" class="input-size--large" name="input_activity" id="input_activity'+e.id+'" list="datalist_activity'+e.id+'" placeholder="Aktivit√§t (Wenn vorhanden)"/>\n          <datalist id="datalist_activity'+e.id+'">\n            <option>- WP2 - AEM Dashboard</option>\n            <option>AP01 - Front-end</option>\n          </datalist>\n        </div>\n        <div class="project-detection-item--dzbankprores">\n          \n        </div>\n     </div>\n     <div class="config-item-action-container">\n       <button class="button-primary button-reset button_deleteDetection">\n         <?xml version="1.0" encoding="utf-8"?>\n         \x3c!-- Designed by Empty Soul  --\x3e\n         <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n            viewBox="0 0 1000 1000" style="enable-background:new 0 0 1000 1000;" xml:space="preserve">\n         <g>\n           <path d="M200.3,269.8v602.4c0,71.7,58.3,130,130,130h333.6c71.7,0,130-58.3,130-130V269.8H200.3z M733.9,872.2\n             c0,38.6-31.4,70-70,70H330.3c-38.6,0-70-31.4-70-70V329.8h473.6V872.2z"/>\n         </g>\n         <g>\n           <rect x="326" y="400.4" width="60" height="480.3"/>\n         </g>\n         <g>\n           <path d="M670,143.8c-4.6-33-16.7-63.6-35.2-88.2c-26-34.4-61.3-53.4-99.4-53.4H459c-38.2,0-73.5,19-99.4,53.4\n             c-18.5,24.6-30.7,55.2-35.2,88.2h-126v60h597.7v-60H670z M385,143.8c3.8-19.7,11.5-37.6,22.4-52.1c14.3-19,32.6-29.5,51.5-29.5\n             h76.4c18.9,0,37.2,10.5,51.5,29.5c10.9,14.5,18.5,32.4,22.4,52.1H385z"/>\n         </g>\n         <g>\n           <rect x="612" y="400.4" width="60" height="480.3"/>\n         </g>\n         <g>\n           <rect x="467.2" y="400.4" width="60" height="480.3"/>\n         </g>\n         </svg>                  \n       </button>\n     </div>\n     </div>')).join(""))}const f="select_bookingPlatform_",p=document.getElementById("button_add_projectDetection");let h=localStorage.getItem("tc_c_projectDetection");h=JSON.parse(h);const v=document.getElementById("window_detection"),_="select_proTime_service_CSITEST";function b(e){localStorage.setItem("tc_c_projectDetection",JSON.stringify(e))}function y(){let e="deci"+(new Date).getTime().toString(),t={id:e,bookingsheet:""};null===h&&(h=[]),h.push(t),b(h),g(h),w(),document.getElementById(e).classList.add("item--new"),v.parentElement.scroll({top:0,behavior:"smooth"})}function w(){let e=document.getElementsByClassName("button_deleteDetection");for(let t=0,n=e.length;t<n;t++)e[t].addEventListener("click",x);for(let t=0,n=e.length;t<n;t++)e[t].addEventListener("click",x);let t=document.getElementsByName("item_detection");for(let e=0,n=t.length;e<n;e++){let n=document.getElementById(f+t[e].id),i=h.find((n=>n.id===t[e].id)).bookingsheet;n.value=""!==i&&null!==i?f+i:i,n.addEventListener("change",(()=>{E(t[e].id,n.value)}));let o=document.getElementById("input_ticketPrefix"+t[e].id);o.addEventListener("change",(()=>{T(t[e].id,"ticketprefix",o.value)}));let r=document.getElementById("input_additionalPrefix"+t[e].id);r.addEventListener("change",(()=>{T(t[e].id,"addprefix",r.value)}));let c=document.getElementById("select_proTimeService_"+t[e].id),a=h.find((n=>n.id===t[e].id)).protimeservice;c.value=a,c.addEventListener("change",(()=>{T(t[e].id,"protimeservice",c.value)}));let l=document.getElementById("input_projectNomber"+t[e].id);l.addEventListener("change",(()=>{T(t[e].id,"projectnomber",l.value)}));let s=document.getElementById("input_activity"+t[e].id),d=h.find((n=>n.id===t[e].id)).protimeactivity;s.value=d,s.addEventListener("change",(()=>{T(t[e].id,"protimeactivity",s.value)}))}}function k(e){return h.find((t=>t.id===e))}function E(e,t){let n=k(e),i=t.split(f)[1],o={};t===f+"AmagProTime"?o={ticketprefix:"",addprefix:"",protimeservice:_,projectnomber:"",protimeactivity:""}:t===f+"DZBankProRes"&&(o={ticketprefix:"",addprefix:""});let r={...n,bookingsheet:i,...o},c=h.indexOf(n);h[c]=r,b(h),g(h),w()}function T(e,t,n){!function(e,t,n){let i=k(e),o={...i,[t]:n},r=h.indexOf(i);h[r]=o}(e,t,n),b(h),g(h),w()}function x(e){let t=e.target.closest("div").parentNode.id,n=document.getElementById(t);n.classList.add("config-item--remove"),setTimeout((function(){n.remove()}),500),e.target.closest("button").removeEventListener("click",x),h=h.filter((e=>e.id!==t)),b(h)}document.addEventListener("DOMContentLoaded",(async function(){let n=await async function(){return new Promise((async e=>{let t=localStorage.getItem("tc_s_dlcplatforminformations");if(t)t=JSON.parse(t);else{let e=await async function(){return new Promise((async e=>{let t=localStorage.getItem("tc_s_dlcplatforminformations");if(t)e(t);else{let n=await async function(){return new Promise((async e=>{let t=[];for(let e of l){let n=Promise.resolve(c(647)(`./${e}/info.json`));await n.then((n=>{let i={[e]:{...n}};t.push(i)}))}e(t)}))}();try{if(!n)throw new Error("unable to create dlc import data");t=localStorage.setItem("tc_s_dlcplatforminformations",JSON.stringify(n)),e(t)}catch(e){}}}))}();try{if(!e)throw new Error("unable to import dlc platform data");console.log("dlc data created, restart time copy..."),window.location.reload()}catch(e){console.log(e),window.location.reload()}}for(let e of l){let n,i=t.find((t=>t[e]))[e],o="",r=".png";e===s&&(r=".gif"),"true"===i.platform_content&&(n=await m(e),o=n.customContent);let c='<label class="config-item dFlex">\n                <div class="config-item-main-container dFlex">\n                  <div class="config-item-radio-container dFlex">\n                    <label class="radio-custom-container dFlex">\n                      <input type="radio" class="radio-default" name="booking-platform"\n                        value="bookingPlatform_'+e+'" />\n                      <span class="checkmark"></span>\n                    </label>\n                  </div>\n                  <div class="config-item-logo-container flex config-item-logo-container--'+i.platform_id+'">\n                    <img src="assets/gfx/dlc/platforms/logos/'+(e+r)+'" class="icon-bookingItem" />\n                  </div>\n                  <div class="config-item-main flex">\n                    <p class="text-label">'+i.platform_name+'</p>\n                  </div>\n                </div>\n                <div class="config-item-action-container flex">\n                  <button class="button-primary" id="bookingPlatform_'+e+'">\n                    <?xml version="1.0" encoding="utf-8"?>\n                    <svg version="1.1" id="DownArrow" xmlns:serif="http://www.serif.com/"\n                    \t xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 1200 1200"\n                    \t style="enable-background:new 0 0 1200 1200;" xml:space="preserve">\n                    <path id="downarrow_smooth" class="st0" d="M671.2,910.4l502.1-502.1c35.1-35.1,35.1-92.2,0-127.3c-35.1-35.1-92.2-35.1-127.3,0\n                    \tL599.6,727.3L153.4,281.1c-35.1-35.1-92.2-35.1-127.3,0C-9,316.3-9,373.3,26.2,408.4l510.3,510.3c35.1,35.1,92.2,35.1,127.3,0\n                    \tC666.4,916.1,668.9,913.3,671.2,910.4z"/>\n                    </svg>\n                  </button>\n                </div>\n              </label>'+o;document.getElementById("window_bookingplatforms").innerHTML+=c}e("DLC Content ready")}))}();try{if(!n)throw new Error("platform contents not loaded")}catch(e){return void console.log(e)}const i=document.querySelector("link#link-theme"),o=(document.querySelector("main"),document.querySelector("header")),r=document.querySelector("div.configurations"),a=document.querySelector("div.overview"),f=document.getElementById("config-container"),v=document.getElementsByClassName("configuration-window"),_=document.getElementById("config-win-general"),b=document.getElementById("config-win-timesheets"),k=document.getElementById("config-win-bookingsheet"),E=document.getElementById("config-win-projects"),T=document.getElementById("configProfileName"),x=document.getElementsByClassName("button-config-tab"),S=document.querySelector("button#button-tab-general"),I=document.querySelector("button#button-tab-timesheets"),L=document.querySelector("button#button-tab-bookingsheets"),N=document.querySelector("button#button-tab-projects"),B=document.querySelector("button#buttonBackToMain"),C=document.querySelector("button#button_test_pasteTicketData"),P=document.querySelector("button#fillButton"),j=document.querySelector("button#configButton"),O=document.querySelector("select#select-themes"),D=(document.querySelector("select#select-language"),document.getElementById("button_clearConfigs")),A=document.getElementsByName("timesheet-filter"),M=document.getElementById("button_openHelp"),F=(document.getElementById("tobiasFilterInfo"),document.getElementsByName("timesheet-filter")),q=document.getElementsByName("booking-platform");let H=localStorage.getItem("tc_c_theme"),R=localStorage.getItem("tc_c_language"),z=localStorage.getItem("tc_c_filter"),Z=localStorage.getItem("tc_c_projectDetection"),J=localStorage.getItem("tc_c_profileName"),U=localStorage.getItem("tc_c_bookingPlatform"),$=!1,V=!1,W=!1,G=e.Re,K=e.rf,Y=e.Fe;function Q(){const e="oceanswave";let t=s;H&&"null"!==H&&" "!==H?(O.value=H,i.setAttribute("href","./assets/style/themes/"+H+"/"+H+".css")):(O.value=e,i.setAttribute("href","./assets/style/themes/"+e+"/"+e+".css")),z&&(document.querySelector('input[value="'+z+'"]').checked=!0),T.value=J||"Default",U?document.querySelector('input[value="'+d+U+'"]').checked=!0:(document.querySelector('input[value="'+d+t+'"]').checked=!0,localStorage.setItem("tc_c_bookingPlatform",t)),console.log("‚úÖ [Time Copy] extension loaded")}function X(){$?(j.classList.remove("button--active"),P.classList.remove("object--hidden"),r.classList.add("dNone"),a.classList.remove("dNone"),o.classList.add("dNone"),$=!1,!0===W&&window.location.reload()):(j.classList.add("button--active"),P.classList.add("object--hidden"),r.classList.remove("dNone"),a.classList.add("dNone"),o.classList.remove("dNone"),$=!0)}function ee(){[].forEach.call(x,(function(e){e.classList.remove("button-tab--active")})),[].forEach.call(v,(function(e){e.classList.add("dNone")}))}function te(){ee(),S.classList.add("button-tab--active"),_.classList.remove("dNone"),f.classList.add("configuration-container-first-tab-selected")}function ne(){ee(),N.classList.add("button-tab--active"),E.classList.remove("dNone"),f.classList.remove("configuration-container-first-tab-selected"),W=!0}function ie(){ee(),I.classList.add("button-tab--active"),b.classList.remove("dNone"),f.classList.remove("configuration-container-first-tab-selected")}function oe(){ee(),L.classList.add("button-tab--active"),k.classList.remove("dNone"),f.classList.remove("configuration-container-first-tab-selected")}function re(){}function ce(e){let t=e.target.value.split(d)[1];localStorage.setItem("tc_c_bookingPlatform",t),W=!0}function ae(){localStorage.setItem("tc_c_profileName",T.value),W=!0}function le(){let e=O.value;i.setAttribute("href","./assets/style/themes/"+e+"/"+e+".css"),localStorage.setItem("tc_c_theme",e),W=!0}function se(e){localStorage.setItem("tc_c_filter",e.target.value),W=!0}function de(){window.open("https://github.com/EmptySoulOfficial/TimeCopy/blob/main/accesories/documentation/Help.md")}function me(){if(!0===W)return sessionStorage.setItem("tc_c_exportFile_afterChange","true"),void window.location.reload();{let e=Z;e=JSON.parse(e);const t="-TimeCopy.tcprofile";null===e&&(e=[]);let n={tcprofile:{author:"steve",version:Y,extension_version:G,extension_build:K,profile_name:T.value}};Object.assign(n.tcprofile,{cfg:{theme:H,language:R,filter:z,platform:U,detections:e}});const i=JSON.stringify(n),o=T.value+t,r="text/plain",c=document.createElement("a"),a=new Blob([i],{type:r});c.href=URL.createObjectURL(a),c.download=o,document.body.appendChild(c),c.click(),c.remove()}}function ue(){localStorage.removeItem("tc_c_theme"),localStorage.removeItem("tc_c_language"),localStorage.removeItem("tc_c_filter"),localStorage.removeItem("tc_c_projectDetection"),localStorage.removeItem("tc_c_profileName"),localStorage.removeItem("tc_c_bookingPlatform"),localStorage.removeItem("tc_s_dlcplatforminformations"),sessionStorage.removeItem("tc_c_messageImported"),sessionStorage.removeItem("tc_c_messageProfileRemoved"),sessionStorage.removeItem("tc_c_changeLanguage"),sessionStorage.setItem("tc_c_messageProfileRemoved","true"),window.location.reload()}async function ge(){let e=await navigator.clipboard.readText(),n=z,i=U;try{if(""===n||null===n)throw new Error("Bitte w√§hle einen Filter!");if(""===i||null===i)throw new Error("Bitte w√§hle eine Buchungsplatform!");if(""===Z||null===Z)throw new Error("Bitte erstelle mindestens ein Erkennungs-Item !");!async function(e,n,i,o){let r=[];try{r=await async function(e,t){let n=[];return"timesheetfilter-tobiasexcel"===e?n=function(e){let t="";e.includes("\t")&&(t=e.split("\t")[0]),e.includes('""')&&(e=e.replace(/""/g,""));let n=e.split('"')[1]??e.split("\t");const i=/([^\n]+)/g,o=/(?<=\[).*?(?=\])/g,r=/(?<=\]).*(?=\:)/g,c=/.*[\s]*?:[\s]*?(\d{1,2}[\.\,]?[\d]{0,2})/,a=/^[^\s#¬∞]+/,l=/(?<=¬∞)[^\s#¬∞]+/,s=/(?<=#)[^\s#¬∞]+/;let d,m=[],u=[];for(;null!==(d=i.exec(n));)m.push(d[1]);return m.forEach((function(e,n){let i="",d=e.match(o)[0].trim(),m=d.match(a)[0],g=d.match(s)?d.match(s)[0]:"",f=d.match(l)?d.match(l)[0]:"",p=e.match(r)[0].trim(),h=e.match(c)[1].trim();h=h.replaceAll(",","."),g&&(i=g);let v={item_bookingnumber:i,item_ticketmasternumber:f,item_ticketnumber:m,item_ticketdisc:p,item_hiddentag:"",item_tickettime:h,item_date:t.trim()};u.push(v)})),u}(t):"timesheetfilter-stevegoogleexcel"===e&&(n=function(e){let t;const n=/(Mo\.|Di\.|Mi\.|Do\.|Fr\.|Sa\.|So\.)\s*\d{2}\.\d{2}\.\d{4}/,i=/^[a-zA-Z\s]{1,3}\s+/g,o=/^\d{1,2}[:.]\d{2}\s*/g,r=/(\w.*[\s]{1}\d{1,2}[,\.]?\d{0,2})(?=\s|$)/g,c=/(?:^|\n)\s*([A-Z0-9]+(?:-[A-Z0-9]+)?(?:>[A-Z0-9]+)?)/i,a=/>(.+)/,l=/\[([^\]]+)\](?=[^\[]*$)/,s=/\[#([^\]]+)\](?=[^\[]*$)/,d=/(?<=\#).*?(?=\])/,m=/\d+[.,]?\d*$/;let u,g="",f="",p=[],h=[];for(e.match(n)?(g=e.match(n)[0].trim(),t=e.replace(n,"").trim()):t=e.trim(),t=t.replaceAll("\t"," "),t.match(i)&&(t=t.replace(i,"").trim()),t.match(o)&&(f=t.match(o)[0].trim(),t=t.replace(o,"").trim());null!==(u=r.exec(t));)p.push(u[1]);return p.forEach((function(e,t){let n="",i="",o="",r="",u="",f="",p=(e=e.replaceAll("\t"," ")).match(c)[0].trim();p.match(a)?(o=p.replace(a,"").trim(),r=p.replace(o+">","").trim()):o=p.trim(),e.match(l)&&(e.match(s)?(u=e.match(s)[0].trim(),u=u.match(d)[0].trim(),i=u,e=e.replace(s,"")):(f=e.match(l)[1].trim(),e=e.replace(l,"")));let v=e.match(m)[0];v=v.replaceAll(",",".");let _=e.replace(p,"").trim();_=_.replace(u,"").trim(),_=_.replace(m,"").trim(),n=g.replace("\t","").trim();let b={item_bookingnumber:i,item_ticketmasternumber:r,item_ticketnumber:o,item_ticketdisc:_,item_hiddentag:f,item_tickettime:v,item_date:n};h.push(b)})),console.log(h),h}(t)),n}(e,n),console.log("Timesheet Data: ",r)}catch(e){return console.error("Unable to call bookingData: ",e),void t(!0,!1,"Fehler: Buchungsdaten konnten nicht aufgerufen werden")}console.log("App Booking Platform "+i);let c=await u(i,r,Z,o);try{if(!c)throw new Error("Bookingprocess failed");console.log("‚úÖ Booking process return okey | ",c)}catch(e){return void console.log(e)}}(n,e,i,V)}catch(e){return void t(!0,!1,e)}}async function fe(){V=!0,ge()}async function pe(){V=!1,ge()}document.getElementById("button_importConfigs").addEventListener("change",(function(e){let n;var i=e.target.files,o=new FileReader;o.addEventListener("load",(function(e){n=this.result,n=JSON.parse(n),e=function(e){let t;return t=e.tcprofile.version===Y,t}(n),console.log(e),e?(localStorage.setItem("tc_c_theme",n.tcprofile.cfg.theme),localStorage.setItem("tc_c_language",n.tcprofile.cfg.language),localStorage.setItem("tc_c_filter",n.tcprofile.cfg.filter),localStorage.setItem("tc_c_projectDetection",JSON.stringify(n.tcprofile.cfg.detections)),localStorage.setItem("tc_c_profileName",n.tcprofile.profile_name),localStorage.setItem("tc_c_bookingPlatform",n.tcprofile.cfg.platform),Q(),sessionStorage.setItem("tc_c_messageImported","true"),window.location.reload(),setTimeout((function(){}),2e3)):t(!0,!1,"Import fehlgeschlagen: Version stimmt nicht √ºberein.")})),o.readAsText(i[0])}),!1),document.getElementById("button_exportConfigs").addEventListener("click",me),g(h),w(),p.removeEventListener("click",y),p.addEventListener("click",y),window.addEventListener("load",(e=>{label_version.insertAdjacentHTML("beforeend",G),label_build_version.insertAdjacentHTML("beforeend",K),P.addEventListener("click",pe),C.addEventListener("click",fe),j.addEventListener("click",X),B.addEventListener("click",X),S.addEventListener("click",te),N.addEventListener("click",ne),I.addEventListener("click",ie),L.addEventListener("click",oe),T.addEventListener("change",ae),D.addEventListener("click",ue),M.addEventListener("click",de),O.addEventListener("change",le);for(var n=0,i=A.length;n<i;n++)A[n].addEventListener("click",se);for(var o=0,r=F.length;o<r;o++)F[o].addEventListener("click",re);for(o=0,r=q.length;o<r;o++)q[o].addEventListener("click",ce);Q(),function(){let e=sessionStorage.getItem("tc_c_messageImported"),n=sessionStorage.getItem("tc_c_messageProfileRemoved"),i=sessionStorage.getItem("tc_c_exportFile_afterChange"),o=sessionStorage.getItem("tc_c_changeLanguage");"true"===e&&(t(!0,!0,"Profil wurde erfolgreich importiert!"),sessionStorage.removeItem("tc_c_messageImported"),j.click()),"true"===n&&(t(!0,!0,"Profil wurde zur√ºckgesetzt."),sessionStorage.removeItem("tc_c_messageProfileRemoved"),j.click()),"true"===i&&(sessionStorage.removeItem("tc_c_exportFile_afterChange"),j.click(),me()),"true"===o&&(sessionStorage.removeItem("tc_c_changeLanguage"),j.click())}(),function(){const e=document.getElementById("config-win-general--content"),t=document.getElementById("label_version"),n=document.getElementById("button_test_pasteTicketData");t.insertAdjacentHTML("afterbegin","‚≠êÔ∏è "),e.insertAdjacentHTML("beforeend",'\n<div class="config-item dFlex">\n<div class="config-item-main-container">\n  <div class="config-item-title-row flex">\n    <div class="config-item-icon-container flex">\n      <p class="text-label label-emoji">üë©üèº‚Äçüíª</p>\n    </div> \n    <div class="config-item-main flex"> \n      <p class="text-label">Developer Tools</p>\n    </div> \n  </div>\n  <div class="config-item-content-row flex">\n  <p class="text-label padding-right-10">ProTime Test</p>\n    <label class="switch">\n      <input type="checkbox" class="" id="check_showProTimetestButton" />\n      <span class="switch_slider"></span>\n    </label>\n\n  </div> \n</div>\n</div>');const i=document.getElementById("check_showProTimetestButton");function o(){i.checked?(n.classList.remove("dNone"),localStorage.setItem("tc_c_dev_pttest","true")):(n.classList.add("dNone"),localStorage.setItem("tc_c_dev_pttest","false"))}i.addEventListener("change",o),window.addEventListener("load",(()=>{"true"==localStorage.getItem("tc_c_dev_pttest")&&(i.checked=!0,o())}))}()}))}))})()})();